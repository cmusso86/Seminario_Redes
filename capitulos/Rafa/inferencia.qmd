---
title: "Import√¢ncia de Vari√°veis"
---

# Infer√™ncia Causal

## Motivation

::: {style="text-align: center; margin-top: 1.5em; font-size: 1.3em"}
::: incremental
-   Given a patient who returned from Africa with a fever and body aches, the most likely explanation was malaria
-   But AI got mired in [probabilistic associations]{style="color:Violet"}
-   The key, [Judea Pearl] argues, is to replace reasoning by association with [causal reasoning]{style="color:MediumSeaGreen"}
:::
:::
 
::: footer
[To Build Truly Intelligent Machines, Teach Them Cause and Effect](https://www.quantamagazine.org/to-build-truly-intelligent-machines-teach-them-cause-and-effect-20180515/), *Judea Pearl* interview.
:::

## Inteligent Machines and Causal Reasoning

::: {.nonincremental}
- Instead of the mere ability to correlate fever and malaria, machines [need the capacity to reason that malaria causes fever]{style="color:red"}. 
- Then, it becomes possible for machines to ask counterfactual questions 
  - How the causal relationships would change given some kind of intervention?
- Pearl views it as the cornerstone of scientific thought. 
:::

::: footer
[To Build Truly Intelligent Machines, Teach Them Cause and Effect](https://www.quantamagazine.org/to-build-truly-intelligent-machines-teach-them-cause-and-effect-20180515/), *Judea Pearl* interview.
:::

## Causal Inference 


::: {.incremental}
- Mathematics has not developed the asymmetric language required to capture our understanding that if $X$ causes $Y$ that [does not mean]{style="color:red"} that $Y$ causes $X$^["It sounds like a terrible thing to say against science, I know. If I were to say it to my mother, she‚Äôd slap me."]
- Pearl proposes a formal language in which to make this kind of thinking possible 
- According him, it is a 21st-century version of the Bayesian framework that allowed machines to [think probabilistically]{style="color:Violet"}
:::

::: footer
[To Build Truly Intelligent Machines, Teach Them Cause and Effect](https://www.quantamagazine.org/to-build-truly-intelligent-machines-teach-them-cause-and-effect-20180515/), *Judea Pearl* interview.
:::

## Pearl's Criticism on Deep Learning 


::: {.nonincremental}
- He did not expect that so many problems could be solved by [pure curve fitting]{style="color:red"}.^["If you deprive the robot of your intuition about cause and effect, you‚Äôre never going to communicate meaningfully. Robots could not say 'I should have done better'."] 
- "But what next?"
    - "Can you have a [robot scientist]{style="color:Violet"} that would plan an experiment and find new answers to pending scientific questions? That‚Äôs the next step."
:::

::: footer
[To Build Truly Intelligent Machines, Teach Them Cause and Effect](https://www.quantamagazine.org/to-build-truly-intelligent-machines-teach-them-cause-and-effect-20180515/), *Judea Pearl* interview.
:::


## Ladder of Causation {auto-animate="true"}

![](capitulos/Rafa/seeing.png){width="550" height="475"}


::: footer
Judea Pearl and Dana Mackenzie. *The book of Why: The New Science of Cause and Effect.* Basic Books, 2018.
:::

## Ladder of Causation {auto-animate="true"}

![](capitulos/Rafa/doing.png){width="550" height="475"}

::: footer
Judea Pearl and Dana Mackenzie. *The book of Why: The New Science of Cause and Effect.* Basic Books, 2018.
:::

## Ladder of Causation {auto-animate="true"}

![](capitulos/Rafa/imagining.png){width="750" height="475"}

::: footer
Judea Pearl and Dana Mackenzie. *The book of Why: The New Science of Cause and Effect.* Basic Books, 2018.
:::

## Ladder of Causation {auto-animate="true"}

![](capitulos/Rafa/causal-ladder.png){.absolute width="600" top=0 height="675" left="600"}

::: footer
Judea Pearl and Dana Mackenzie. *The book of Why: The New Science of Cause and Effect.* Basic Books, 2018.
:::

# CI and DNN Aplications

## Summary of examples

::: {.nonincremental}
- Counterfactual explanations
- Causal Discovery in the hidden layer of a DNN (CNN)
- Deep Causal Learning
- Supply disruptions
:::


## Counterfactual


::: footer
[Christoph Molnar](https://christophm.github.io/interpretable-ml-book/). *Interpretable Machine Learning*, 2023.
:::


---

![](capitulos/Rafa/deep-causal-learning.png){.absolute width="1200" top=0 height="650" left="0"}

::: footer
Deep Causal Learning example. Real model: ùê∏(ùëã3|ùëëùëú(ùëã2 = ùë•)) = ‚àí1.1ùë• + 84. Source: [Zizhen Deng, Xiaolong Zheng, Hu Tian, Daniel Dajun Zeng](http://arxiv.org/abs/2211.03374). *Deep Causal Learning: Representation, Discovery and Inference*, 2022.
:::


## Steps for CI and DNN in Supply disruptions

::: {.incremental}
1. The requirements and processes which are essential for a [causality-related data]{style="color:Violet"} mining phase;
2. A suitable selection of features to enable a best possible forecast of supply disruptions; and
3. [Effective combination]{style="color:Violet"} of the DNN and causal inference theory by evaluating propensity scores^["propensity score methods are used for removing the effects of confounding when estimating the effects of treatment on outcomes:". See more in [Peter C. Austin's 2011 paper](https://doi.org/10.1080/00273171.2011.568786).].
:::
 

::: footer
Source: [Bodendorf, Sauter, and Franke](https://www.sciencedirect.com/science/article/abs/pii/S0925527322002900?via%3Dihub), 2023. 
:::

---

![](capitulos/Rafa/framework.png){.absolute width="1400" top=0 height="800" left="0"}


## Usefulness of CI and DNN in Supply disruptions

::: {.nonincremental}
- [Shedding light into black-box]{style="color:MediumSeaGreen"} DNN models by calculating propensity scores and estimating treatment effects
- Identifying [causal relationships]{style="color:MediumSeaGreen"} between supplier characteristics and the expected delivery performance 
- Discovering lacking supplier relationships and consequently bundling supply chain risk management-related activities
:::
 

::: footer
[Frank Bodendorf, Maximilian Sauter, J√∂rg Franke](https://www.sciencedirect.com/science/article/abs/pii/S0925527322002900?via%3Dihub).
*A mixed methods approach to analyze and predict supply disruptions by combining causal inference and deep learning*. 2023. International Journal of Production Economics, Volume 256.
:::


---

![](capitulos/Rafa/graph.png){.absolute width="1400" top=0 height="800" left="0"}

## Examples of conclusions

::: {.nonincremental}
- [Country]{style="color:MediumSeaGreen"}: comparing suppliers based on their origin, the strong performance of foreign suppliers is apparent. Overall, deliveries by domestic suppliers are affected by an average reliability [decrease of 39.7%]{style="color:red"}.
- [Product Group]{style="color:MediumSeaGreen"}: raw material suppliers show a superior delivery performance ([increase of 55.2%]{style="color:red"}) in comparison to vendors offering operating supplies, measurement equipment, and spare parts.
:::




